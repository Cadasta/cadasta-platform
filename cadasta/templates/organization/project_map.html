{% extends "organization/project_wrapper.html" %}

{% load i18n %}

{% load staticfiles %}

{% block extra_head %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css" />
<link rel="stylesheet" href="{% static 'css/leaflet.groupedlayercontrol.min.css' %}">
<link rel="stylesheet" href="{% static 'css/MarkerCluster.css' %}">
<link rel="stylesheet" href="{% static 'css/MarkerCluster.Default.css' %}">
{% endblock %}

{% block extra_script %}
<script src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>
<script src="{% static '/js/leaflet.groupedlayercontrol.min.js' %}"></script>
<script src="{% static 'js/leaflet.markercluster.js' %}"></script>
<script src="{% static 'js/L.Map.Deflate.js' %}"></script>
<script src="{% static 'js/smap/index.js' %}"></script>

<script>
  var url = '/async/organizations/' +
      '{{ project.organization.slug }}/projects/{{ project.slug }}/spatial/tiled/{z}/{x}/{y}'
  var fetch_spatial_resources = '/api/v1/organizations/' +
      '{{ project.organization.slug }}/projects/{{ project.slug }}/spatialresources/';
  var trans = {open: "{% trans 'Open location' %}"};
  {% if project.extent %}
    var projectExtent = {{ project.extent.geojson|safe }};
  {% else %}
    var projectExtent = null;
  {% endif %}
  var options = {
    projectExtent: projectExtent,
    trans: trans,
    // SHOULD BE USED: fitBounds: '{{ boundary }}',
    fitBounds: 'project',
    project_slug: '{{ project.slug }}',
    org_slug: '{{ project.organization.slug }}'
  }

  var layers = {{ leaflet_tiles|safe }}

</script>
{% endblock %}

{% block page_title %}{% trans "Overview" %} | {% endblock %}
{% block body-class %} map{% endblock %}
{% block left-nav %}overview{% endblock %}

{% block content %}
<div class="col-md-12 content-single">
  <div class="row">
    <!-- Start overview map  -->
    <div class="col-md-8 map" id="project-map">
      <div id="mapid"></div>
    </div>
    <!-- / end overview map -->
    <!-- Overview detail  -->
    <div class='col-md-4 detail'>
    <!-- THIS IS WHERE THE NEW SIDE MENU DETAILS GO -->
    </div>
  </div>
  <!-- / overview detail -->
</div>
{% endblock %}
